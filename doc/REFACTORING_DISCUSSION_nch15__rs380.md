# Commands involving turtle queries

Our code relies on a split in the back-end between the interpreter section and the executor section, where the interpreter "translates" user commands and packages them before sending them to the executor, which can deal with them without having to worry about parsing anything other than commands related to the turtle, and one command per execution statement. That is, if the user entered "fd + 10 10", the interpreter would change that to "fd 20" and pass it to the executor. However, we ran into a problem when it came to parsing user commands that contained within them turtle queries, such as "fd + 10 xCor". The interpreter wouldn't know how to interpret this, since it doesn't know what xCor is. More importantly, it *shouldn't* know what xCor is, since the turtle values are entirely encapsulated and can be seen only from inside the turtle. Instead, we built a channel that facilitated communication between the interpreter and the executor, so that they can exchange information without having to hold instances of each other. This refactor allows for the interpreter and executor to break down the user commands, where interpreter would call the publish() method and pass it "xCor", the executor would use the subscribe() method to receive that value, and then would use publish() again to pass back the appropriate data.

# Who handles multiple turtles?

If the interpreter gets the user command "fd sum 10 xCor", it originally expected xCor to be a single value. However, if there are multiple turtles active, xCor will be different for all of them. The way the code is set up now, this would mean that the interpreter would have to have the loop running through multiple turtles, but this entirely violates encapsulation. In order to stick with the conceptual design we agreed on, the interpreter should not ever see the turtles, or know how many turtles are active. We refactored this code so that the loop is in the executor, and the executor can return for xCor more than one value, and the interpreter deals with xCor not knowing how long it is. We also refactored the CommandUnit class so it can accept for a value a Collection.